<!DOCTYPE html>
<html lang="fr" data-th-replace="~{layout::layout(contenu=~{::main},titre=~{::title})}" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Nouvelle vente</title>
</head>
<main>
    <div class="container">
        <h1>Nouvelle vente</h1>
        
        <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
        <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>

        <form th:action="@{/vendre}" method="post" class="vente-form">
            <div class="form-group">
                <label for="nomArticle">Article :</label>
                <input type="text" id="nomArticle" name="nomArticle" th:value="${article?.nom_article}" required>
            </div>

            <div class="form-group">
                <label for="categorie">Catégorie :</label>
                <select id="categorie" name="categorie" required>
                    <option value="">Sélectionnez une catégorie</option>
                    <option th:each="cat : ${categories}"
                            th:value="${cat.no_categorie}"
                            th:text="${cat.libelle}">
                    </option>
                </select>
            </div>

            <div class="form-group">
                <label for="description">Description :</label>
                <textarea id="description" name="description" th:text="${article?.description}" required></textarea>
            </div>

            <div class="form-group">
                <label for="miseAPrix">Mise à prix :</label>
                <input type="number" id="miseAPrix" name="miseAPrix" th:value="${article?.prix_initial}" required min="1">
            </div>

            <div class="form-group">
                <label for="dateDebut">Début de l'enchère :</label>
                <input type="datetime-local" id="dateDebut" name="dateDebut" required>
            </div>

            <div class="form-group">
                <label for="dateFin">Fin de l'enchère :</label>
                <input type="datetime-local" id="dateFin" name="dateFin" required>
            </div>

            <div class="form-group">
                <label>Retrait :</label>
                <div th:if="${utilisateur?.adresse}" class="retrait-info">
                    <p>
                        <span th:text="${utilisateur.adresse.rue}"></span><br>
                        <span th:text="${utilisateur.adresse.code_postal}"></span>
                        <span th:text="${utilisateur.adresse.ville}"></span>
                    </p>
                    <input type="hidden" name="retrait" th:value="${utilisateur.adresse.no_adresse}">
                </div>
                <div th:unless="${utilisateur?.adresse}" class="alert alert-warning">
                    Vous devez avoir une adresse de retrait pour vendre un article.
                </div>
            </div>

            <div class="form-buttons">
                <button type="submit" name="action" value="enregistrer" class="btn btn-primary">Enregistrer</button>
                <button type="submit" name="action" value="annulerVente" class="btn btn-secondary">Annuler</button>
            </div>
        </form>
        <div>
            <a th:href="@{/ajouter-photo}">Photo</a>
        </div>
    </div>
</main>
</html>