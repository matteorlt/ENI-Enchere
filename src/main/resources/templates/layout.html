<!DOCTYPE html>
<html data-th-fragment="layout(contenu,titre)" lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" data-th-href="@{/css/main.css}">
    <link rel="stylesheet" data-th-href="@{/css/alert.css}">
    <link rel="stylesheet" data-th-href="@{/css/force-mdp.css}">
    <link rel="icon" type="image/png" data-th-href="@{/images/logoENI.png}">
    <title data-th-replace="${titre}">Layout</title>
</head>
<script th:inline="javascript">
    console.log('Script charg√© !');

    document.addEventListener('DOMContentLoaded', function() {


        function updateCountdown() {
            const countdownElement = document.getElementById('countdown');

            if (!countdownElement) {
                return;
            }

            const dateFinStr = countdownElement.getAttribute('data-date-fin');

            if (!dateFinStr) {
                countdownElement.innerHTML = "Erreur: pas de date";
                return;
            }

            // Conversion de la date en timestamp
            const dateFin = new Date(dateFinStr);
            const maintenant = new Date();

            const difference = dateFin - maintenant;

            if (difference <= 0) {
                countdownElement.innerHTML = "L'ench√®re est termin√©e";
                return;
            }

            const jours = Math.floor(difference / (1000 * 60 * 60 * 24));
            const heures = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));
            const secondes = Math.floor((difference % (1000 * 60)) / 1000);

            countdownElement.innerHTML = `${jours}j ${heures}h ${minutes}m ${secondes}s`;
        }

        // Mettre √† jour toutes les secondes
        updateCountdown();
        setInterval(updateCountdown, 1000);
    });
</script>
<body>

<header class="layout-header">
    <h2 class="layout-header__nav-title">
        <a href="/" class="logo-link">
            <img src="/images/logoENI.png" alt="Logo ENI" class="nav-logo">
            <span>Les objets sont nos amis !!</span>
        </a>
<!--        <th:block data-th-if="${#authorization.expression('isAuthenticated()')}">-->
<!--            <div class="layout-user-info">-->
<!--                <span>Bienvenue, </span>-->
<!--                <span data-th-text="${#authentication.name}" class="layout-user-info__pseudo"></span>-->
<!--                <th:block data-th-if="${#authorization.expression('hasRole(''ADMIN'')')}">-->
<!--                    <span class="layout-admin-badge">üõ°Ô∏è</span>-->
<!--                </th:block>-->
<!--            </div>-->
<!--        </th:block>-->
    </h2>
    <nav class="layout-nav">
        <ul class="layout-nav__list">
            <li class="layout-nav__item"><a href="/enchere" class="layout-nav__link">Enchere</a></li>
            <th:block data-th-if="${#authorization.expression('isAuthenticated()')}">
                <li class="layout-nav__item"><a data-th-href="@{/mon-profil(pseudo=${#authentication.name})}" class="layout-nav__link">Profil</a></li>
                <li class="layout-nav__item"><a data-th-href="@{/vendre}" class="layout-nav__link">Vendre Un Article</a></li>
                <li class="layout-nav__item"><a data-th-href="@{/vendeur/gestion-articles}" class="layout-nav__link">üì¶ Mes Articles</a></li>
                <th:block data-th-if="${#authorization.expression('hasRole(''ADMIN'')')}">
                    <li class="layout-nav__item"><a data-th-href="@{/admin/gestion-encheres}" class="layout-nav__link layout-nav__link--admin">üõ°Ô∏è Administration</a></li>
                </th:block>
                <li class="layout-nav__item"><a data-th-href="@{/logout}" class="layout-nav__link">Se d√©connecter</a></li>
            </th:block>
            <th:block data-th-if="${!#authorization.expression('isAuthenticated()')}">
                <li class="layout-nav__item"><a data-th-href="@{/connexion}" class="layout-nav__link">Se connecter</a></li>
                <li class="layout-nav__item"><a data-th-href="@{/creer-compte}" class="layout-nav__link">S'inscrire</a></li>
            </th:block>
        </ul>
    </nav>
</header>

<main class="layout-main layout-main--center" data-th-replace="${contenu}">
    <section class="section">
        <h1>Bienvenue sur ENI-Ench√®res</h1>
        <h2>Votre plateforme d'ench√®res en ligne</h2>
        <p>D√©couvrez des objets uniques et participez aux ench√®res !</p>
    </section>
</main>
<th:block th:replace="~{fragments/scripts :: scripts}"></th:block>
<footer class="layout-footer">
    <div class="layout-footer__content">
        <p class="layout-footer__text">&copy; ENI - Tous droits r√©serv√©s</p>
        <div class="footer-links">
            <a href="/mentions-legales">Mentions l√©gales</a>
            <a href="/contact">Contact</a>
            <a href="/a-propos">√Ä propos</a>
        </div>
    </div>
</footer>

</body>
</html>